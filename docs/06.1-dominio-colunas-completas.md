# 06.1 - Domínio de Colunas Canônico (data/processed)

Documento baseado no schema canônico do pipeline em `src/data/transform.py` e aplicado em `data/processed/**/*.parquet`.

## Base e Critério

- Base analítica: `data/processed/**/*.parquet`.
- Colunas padrão: dicionário enxuto/coeso definido em `COMMON_COLUMNS`, `SIA_COMPACT_COLUMNS` e `SIH_COMPACT_COLUMNS`.
- Colunas derivadas: `custo_total`, `idade_grupo`, `cid_capitulo`, `ano_mes`.

## Contagens

- Comuns (padrão): `16`
- SIA padrão (inclui comuns): `58`
- SIH padrão (inclui comuns): `71`
- Derivadas: `4`
- Total final SIA (padrão + derivadas): `62`
- Total final SIH (padrão + derivadas): `75`

## Colunas Padrão Comuns (`16`)

| # | Coluna |
|---:|---|
| 1 | `ano_cmpt` |
| 2 | `mes_cmpt` |
| 3 | `sistema` |
| 4 | `uf_origem` |
| 5 | `main_icd` |
| 6 | `icd_group` |
| 7 | `opm_flag` |
| 8 | `fisio_flag` |
| 9 | `mun_res_status` |
| 10 | `mun_res_tipo` |
| 11 | `mun_res_nome` |
| 12 | `mun_res_uf` |
| 13 | `mun_res_lat` |
| 14 | `mun_res_lon` |
| 15 | `mun_res_alt` |
| 16 | `mun_res_area` |

## Colunas Padrão SIA Específicas (`42`)

| # | Coluna |
|---:|---|
| 1 | `pa_cmp` |
| 2 | `pa_mvm` |
| 3 | `pa_idade` |
| 4 | `idademin` |
| 5 | `idademax` |
| 6 | `pa_sexo` |
| 7 | `pa_racacor` |
| 8 | `pa_etnia` |
| 9 | `pa_ufmun` |
| 10 | `pa_munpcn` |
| 11 | `pa_ufdif` |
| 12 | `pa_mndif` |
| 13 | `pa_coduni` |
| 14 | `pa_cnpjcpf` |
| 15 | `pa_cnpjmnt` |
| 16 | `pa_nat_jur` |
| 17 | `pa_cnsmed` |
| 18 | `pa_cbocod` |
| 19 | `pa_proc_id` |
| 20 | `nome_proced` |
| 21 | `pa_grupo` |
| 22 | `pa_subgru` |
| 23 | `pa_cidpri` |
| 24 | `pa_cidsec` |
| 25 | `pa_cidcas` |
| 26 | `pa_qtdpro` |
| 27 | `pa_qtdapr` |
| 28 | `pa_valpro` |
| 29 | `pa_valapr` |
| 30 | `pa_vl_cf` |
| 31 | `pa_vl_cl` |
| 32 | `pa_vl_inc` |
| 33 | `nu_pa_tot` |
| 34 | `nu_vpa_tot` |
| 35 | `pa_docorig` |
| 36 | `pa_autoriz` |
| 37 | `pa_catend` |
| 38 | `pa_motsai` |
| 39 | `pa_indica` |
| 40 | `pa_tpfin` |
| 41 | `pa_subfin` |
| 42 | `pa_gestao` |

## Colunas Padrão SIH Específicas (`55`)

| # | Coluna |
|---:|---|
| 1 | `n_aih` |
| 2 | `cnes` |
| 3 | `cgc_hosp` |
| 4 | `cnpj_mant` |
| 5 | `munic_res` |
| 6 | `munic_mov` |
| 7 | `uf_zi` |
| 8 | `idade` |
| 9 | `cod_idade` |
| 10 | `sexo` |
| 11 | `nasc` |
| 12 | `raca_cor` |
| 13 | `etnia` |
| 14 | `cep` |
| 15 | `nacional` |
| 16 | `diag_princ` |
| 17 | `diag_secun` |
| 18 | `diagsec1` |
| 19 | `diagsec2` |
| 20 | `diagsec3` |
| 21 | `diagsec4` |
| 22 | `diagsec5` |
| 23 | `diagsec6` |
| 24 | `diagsec7` |
| 25 | `diagsec8` |
| 26 | `diagsec9` |
| 27 | `cid_morte` |
| 28 | `cid_notif` |
| 29 | `cid_asso` |
| 30 | `cid_princ` |
| 31 | `proc_rea` |
| 32 | `proc_solic` |
| 33 | `uti_mes_to` |
| 34 | `uti_int_to` |
| 35 | `qt_diarias` |
| 36 | `dias_perm` |
| 37 | `val_tot` |
| 38 | `val_sh` |
| 39 | `val_sp` |
| 40 | `val_sadt` |
| 41 | `val_ortp` |
| 42 | `val_uti` |
| 43 | `val_uci` |
| 44 | `val_sangue` |
| 45 | `val_acomp` |
| 46 | `dt_inter` |
| 47 | `dt_saida` |
| 48 | `morte` |
| 49 | `cobranca` |
| 50 | `gestao` |
| 51 | `financ` |
| 52 | `faec_tp` |
| 53 | `aud_just` |
| 54 | `sis_just` |
| 55 | `sequencia` |

## Colunas Derivadas Comuns (`4`)

| # | Coluna | Origem |
|---:|---|---|
| 1 | `custo_total` | transform.py |
| 2 | `idade_grupo` | transform.py |
| 3 | `cid_capitulo` | transform.py |
| 4 | `ano_mes` | transform.py |

## 1 linha preenchida (exemplo SIA em data/processed)

```tsv
ano_cmpt	mes_cmpt	sistema	uf_origem	main_icd	icd_group	opm_flag	fisio_flag	mun_res_status	mun_res_tipo	mun_res_nome	mun_res_uf	mun_res_lat	mun_res_lon	mun_res_alt	mun_res_area	pa_cmp	pa_mvm	pa_idade	idademin	idademax	pa_sexo	pa_racacor	pa_etnia	pa_ufmun	pa_munpcn	pa_ufdif	pa_mndif	pa_coduni	pa_cnpjcpf	pa_cnpjmnt	pa_nat_jur	pa_cnsmed	pa_cbocod	pa_proc_id	nome_proced	pa_grupo	pa_subgru	pa_cidpri	pa_cidsec	pa_cidcas	pa_qtdpro	pa_qtdapr	pa_valpro	pa_valapr	pa_vl_cf	pa_vl_cl	pa_vl_inc	nu_pa_tot	nu_vpa_tot	pa_docorig	pa_autoriz	pa_catend	pa_motsai	pa_indica	pa_tpfin	pa_subfin	pa_gestao	custo_total	idade_grupo	cid_capitulo	ano_mes
2021	1	SIA	AC	Q386	Outro	True	False									202101	202101	066	15	130	M	02		12	120001	0	1	2001586	63602940000170	00000000000000	1147	210169361940006	223256	0701070129		07	01	Q386	0000	0000	1	1	150.0	150.0	0.0	0.0	0.0	150.0	0.0	I	0000000000000	01	00	5	06	0000	120000	150.0	60+	Q	202101
```

## 1 linha preenchida (exemplo SIH em data/processed)

```tsv
ano_cmpt	mes_cmpt	sistema	uf_origem	main_icd	icd_group	opm_flag	fisio_flag	mun_res_status	mun_res_tipo	mun_res_nome	mun_res_uf	mun_res_lat	mun_res_lon	mun_res_alt	mun_res_area	n_aih	cnes	cgc_hosp	cnpj_mant	munic_res	munic_mov	uf_zi	idade	cod_idade	sexo	nasc	raca_cor	etnia	cep	nacional	diag_princ	diag_secun	diagsec1	diagsec2	diagsec3	diagsec4	diagsec5	diagsec6	diagsec7	diagsec8	diagsec9	cid_morte	cid_notif	cid_asso	cid_princ	proc_rea	proc_solic	uti_mes_to	uti_int_to	qt_diarias	dias_perm	val_tot	val_sh	val_sp	val_sadt	val_ortp	val_uti	val_uci	val_sangue	val_acomp	dt_inter	dt_saida	morte	cobranca	gestao	financ	faec_tp	aud_just	sis_just	sequencia	custo_total	idade_grupo	cid_capitulo	ano_mes
2021	1	SIH	AC		Diabetes	False	False	ATIVO	MUNIC	Senador Guiomard	AC	-10.14817	-67.74317	208	2321.454	1221100027917	2000725	04034526001115	04034526000143	120045	120045	120000	50	Anos	Feminino	1970-11-15	03	0000	69925000	010	E106	0000										0000		0000	E106	0303030038	0303030038	0	0	4	4	360.8	310.79	50.01	0	0	0	0	0	0	2021-01-12	2021-01-16	Não	Alta melhorado	Estadual plena	06				89	360.8	18-59	E	202101
```

## Referências

- Schema canônico do pipeline: `src/data/transform.py`
- DATASUS TabNet SIA: https://tabnet.datasus.gov.br/cgi/sia/padescr.htm
- DATASUS TabNet SIH: https://tabnet.datasus.gov.br/cgi/sih/midescr.htm
